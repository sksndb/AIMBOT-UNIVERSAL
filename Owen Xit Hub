-- Owen Xit Hub | Aimbot + ESP (FIX CARGA 2026 - GitHub raw)
-- Key remota
local KeySystemEnabled = true
local KeyUrl = "https://pastebin.com/raw/h7RQseud"
local CorrectKey = "fallback_key"
pcall(function()
    local response = game:HttpGet(KeyUrl, true)
    if response and response ~= "" then
        CorrectKey = response:match("^%s*(.-)%s*$") or CorrectKey
    end
end)

local KeyFile = "owen_xit_key.txt"
local function LoadSavedKey()
    if isfile and isfile(KeyFile) then
        local content = readfile(KeyFile)
        return content:match("^%s*(.-)%s*$") or ""
    end
    return nil
end
local function SaveKey(key)
    if writefile then writefile(KeyFile, key) end
end

local savedKey = LoadSavedKey()
if KeySystemEnabled and savedKey ~= CorrectKey then
    local entered = false
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Parent = game.CoreGui
    ScreenGui.Name = "OwenKeyGui"
    ScreenGui.ResetOnSpawn = false
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 300, 0, 180)
    Frame.Position = UDim2.new(0.5, -150, 0.5, -90)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.BorderSizePixel = 0
    Frame.Parent = ScreenGui
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.BackgroundTransparency = 1
    Title.Text = "Owen Xit Hub - Key System (Remota)"
    Title.TextColor3 = Color3.fromRGB(255, 100, 100)
    Title.TextSize = 24
    Title.Font = Enum.Font.SourceSansBold
    Title.Parent = Frame
    local InputBox = Instance.new("TextBox")
    InputBox.Size = UDim2.new(0.8, 0, 0, 40)
    InputBox.Position = UDim2.new(0.1, 0, 0.3, 0)
    InputBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    InputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    InputBox.PlaceholderText = "Ingresa la key..."
    InputBox.Text = ""
    InputBox.Font = Enum.Font.SourceSans
    InputBox.TextSize = 18
    InputBox.Parent = Frame
    local SubmitButton = Instance.new("TextButton")
    SubmitButton.Size = UDim2.new(0.8, 0, 0, 40)
    SubmitButton.Position = UDim2.new(0.1, 0, 0.55, 0)
    SubmitButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    SubmitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    SubmitButton.Text = "Verificar Key"
    SubmitButton.Font = Enum.Font.SourceSansBold
    SubmitButton.TextSize = 20
    SubmitButton.Parent = Frame
    local Status = Instance.new("TextLabel")
    Status.Size = UDim2.new(0.8, 0, 0, 30)
    Status.Position = UDim2.new(0.1, 0, 0.8, 0)
    Status.BackgroundTransparency = 1
    Status.Text = ""
    Status.TextColor3 = Color3.fromRGB(255, 80, 80)
    Status.TextSize = 16
    Status.Font = Enum.Font.SourceSans
    Status.Parent = Frame
    local function CheckKey(keyInput)
        if keyInput == CorrectKey then
            SaveKey(keyInput)
            entered = true
            Status.Text = "¬°Key correcta! Cargando... (guardada)"
            Status.TextColor3 = Color3.fromRGB(0, 255, 100)
            wait(1.5)
            ScreenGui:Destroy()
        else
            Status.Text = "Key incorrecta. Intenta de nuevo."
            InputBox.Text = ""
        end
    end
    InputBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then CheckKey(InputBox.Text) end
    end)
    SubmitButton.MouseButton1Click:Connect(function()
        CheckKey(InputBox.Text)
    end)
    repeat task.wait() until entered or not ScreenGui.Parent
    if not entered then return end
end

-- FIX CARGA: Rayfield desde GitHub raw (m√°s estable en 2026)
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()

local Window = Rayfield:CreateWindow({
   Name = "Owen Xit Hub",
   LoadingTitle = "El Mejor Hub Del Momento",
   LoadingSubtitle = "Cargando...",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "RayfieldConfigs",
      FileName = "OwenXitHub"
   },
   KeySystem = false
})

local AimbotTab = Window:CreateTab("üéØ Aimbot", 4483362458)
local VisualsTab = Window:CreateTab("üé® Visuals", 4483362458)
local SettingsTab = Window:CreateTab("‚öôÔ∏è Settings", 4483362456)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local LP = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Aimbot descarado corregido (Lerp suave pero instant√°neo, sin Scriptable para evitar freeze/pegado en cielo)
getgenv().OwenDescaradoAimbot = {
    Enabled = true,
    TeamCheck = false,
    WallCheck = false,
    LockPart = "Head",
    TriggerKey = Enum.UserInputType.MouseButton2,
    FOV_Enabled = true,
    FOV_Radius = 80,  -- empieza alto para test, baja despu√©s
    FOV_Color = Color3.fromRGB(255, 50, 50),
    FOV_LockedColor = Color3.fromRGB(255, 150, 150),
    FOV_Thickness = 2,
    FOV_Transparency = 0.8,
    FOV_Visible = true,
    SmoothFactor = 0.6  -- 0.6 = r√°pido pero no freeze, 1 = instant snap
}

local Descarado = getgenv().OwenDescaradoAimbot

local FOVCircle = Drawing.new("Circle")
FOVCircle.Visible = false
FOVCircle.Thickness = Descarado.FOV_Thickness
FOVCircle.NumSides = 60
FOVCircle.Transparency = Descarado.FOV_Transparency
FOVCircle.Filled = false

local function UpdateFOVCircle()
    FOVCircle.Radius = Descarado.FOV_Radius
    FOVCircle.Color = Descarado.FOV_Color
    FOVCircle.Thickness = Descarado.FOV_Thickness
    FOVCircle.Transparency = Descarado.FOV_Transparency
    FOVCircle.Visible = Descarado.FOV_Visible and Descarado.Enabled
    FOVCircle.Position = UIS:GetMouseLocation()
end

local function GetClosestTarget()
    local closest = nil
    local minDist = Descarado.FOV_Enabled and Descarado.FOV_Radius or math.huge
    local mousePos = UIS:GetMouseLocation()

    for _, plr in Players:GetPlayers() do
        if plr == LP then continue end
        if Descarado.TeamCheck and plr.Team == LP.Team then continue end

        local char = plr.Character
        if not char then continue end

        local humanoid = char:FindFirstChildOfClass("Humanoid")
        if not humanoid or humanoid.Health <= 0 then continue end

        local part = char:FindFirstChild(Descarado.LockPart)
        if not part then continue end

        local screenPos, onScreen = Camera:WorldToViewportPoint(part.Position)
        if not onScreen then continue end

        local dist = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
        if dist < minDist then
            if Descarado.WallCheck then
                local rayParams = RaycastParams.new()
                rayParams.FilterDescendantsInstances = {LP.Character or {}}
                rayParams.FilterType = Enum.RaycastFilterType.Exclude
                local result = workspace:Raycast(Camera.CFrame.Position, (part.Position - Camera.CFrame.Position), rayParams)
                if result and not result.Instance:IsDescendantOf(char) then continue end
            end
            minDist = dist
            closest = part
        end
    end
    return closest
end

RunService.RenderStepped:Connect(function(delta)
    if not Descarado.Enabled then 
        FOVCircle.Visible = false
        return 
    end

    UpdateFOVCircle()

    if UIS:IsMouseButtonPressed(Descarado.TriggerKey) then
        local targetPart = GetClosestTarget()
        if targetPart then
            print("[DEBUG] Lock en: " .. targetPart.Parent.Name)  -- F9 para ver
            local targetCF = CFrame.new(Camera.CFrame.Position, targetPart.Position + Vector3.new(0, 0.1, 0))
            Camera.CFrame = Camera.CFrame:Lerp(targetCF, Descarado.SmoothFactor)  -- Suave y controlable, no freeze
            FOVCircle.Color = Descarado.FOV_LockedColor
        else
            FOVCircle.Color = Descarado.FOV_Color
        end
    else
        FOVCircle.Color = Descarado.FOV_Color
    end
end)

-- Toggles (agrega tus ESP aqu√≠ si quieres)
AimbotTab:CreateToggle({
   Name = "Enable Aimbot",
   CurrentValue = true,
   Flag = "Aimbot_Enabled",
   Callback = function(v) Descarado.Enabled = v end
})

AimbotTab:CreateToggle({
   Name = "Team Check",
   CurrentValue = false,
   Flag = "Aimbot_TeamCheck",
   Callback = function(v) Descarado.TeamCheck = v end
})

AimbotTab:CreateToggle({
   Name = "Wall Check",
   CurrentValue = false,
   Flag = "Aimbot_WallCheck",
   Callback = function(v) Descarado.WallCheck = v end
})

AimbotTab:CreateToggle({
   Name = "Show FOV Circle",
   CurrentValue = true,
   Flag = "FOV_Visible",
   Callback = function(v) Descarado.FOV_Visible = v end
})

AimbotTab:CreateSlider({
   Name = "FOV Size (80 test, 30-40 rage)",
   Range = {1, 300},
   Increment = 5,
   CurrentValue = 80,
   Flag = "FOV_Radius",
   Callback = function(v) Descarado.FOV_Radius = v end
})

AimbotTab:CreateSlider({
   Name = "Smooth Factor (0.8-1 instant, 0.4 suave)",
   Range = {0.1, 1},
   Increment = 0.1,
   CurrentValue = 0.6,
   Flag = "SmoothFactor",
   Callback = function(v) Descarado.SmoothFactor = v end
})

-- (agrega aqu√≠ tus toggles de VisualsTab y SettingsTab originales si los tienes, sin cambios)

Rayfield:LoadConfiguration()

print("Owen Xit Hub cargado desde GitHub raw - Aimbot sin freeze")
Rayfield:Notify({Title = "¬°Fix Cargado!", Content = "C√°mara normal al apuntar, lock suave/instant\nPrueba FOV 80 + Smooth 0.6", Duration = 8})
