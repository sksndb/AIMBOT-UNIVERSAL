-- Owen Xit Hub | Aimbot + ESP (FIX 2026)
-- Key remota + Rayfield desde GitHub raw (m√°s estable)

local KeySystemEnabled = true
local KeyUrl = "https://pastebin.com/raw/h7RQseud"
local CorrectKey = "fallback_key"
pcall(function()
    local response = game:HttpGet(KeyUrl, true)
    if response and response ~= "" then
        CorrectKey = response:match("^%s*(.-)%s*$") or CorrectKey
    end
end)

local KeyFile = "owen_xit_key.txt"
local function LoadSavedKey()
    if isfile and isfile(KeyFile) then
        local content = readfile(KeyFile)
        return content:match("^%s*(.-)%s*$") or ""
    end
    return nil
end
local function SaveKey(key)
    if writefile then writefile(KeyFile, key) end
end

local savedKey = LoadSavedKey()
if KeySystemEnabled and savedKey ~= CorrectKey then
    -- (tu c√≥digo de key system GUI sin cambios, lo omito por brevedad pero p√©galo aqu√≠ igual)
    -- ... todo el bloque de ScreenGui para key ...
    repeat task.wait() until entered or not ScreenGui.Parent
    if not entered then return end
end

-- FIX: Load Rayfield desde GitHub raw
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/SiriusSoftwareLtd/Rayfield/main/source.lua'))()
local Window = Rayfield:CreateWindow({
   Name = "Owen Xit Hub",
   LoadingTitle = "El Mejor Hub Del Momento",
   LoadingSubtitle = "Cargando...",
   ConfigurationSaving = {Enabled = true, FolderName = "RayfieldConfigs", FileName = "OwenXitHub"},
   KeySystem = false
})

local AimbotTab = Window:CreateTab("üéØ Aimbot", 4483362458)
local VisualsTab = Window:CreateTab("üé® Visuals", 4483362458)
local SettingsTab = Window:CreateTab("‚öôÔ∏è Settings", 4483362456)

-- Tu c√≥digo de aimbot descarado (con el fix de CameraType y debug)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local LP = Players.LocalPlayer
local Camera = workspace.CurrentCamera

getgenv().OwenDescaradoAimbot = {
    Enabled = true,
    TeamCheck = false,
    WallCheck = false,
    LockPart = "Head",
    TriggerKey = Enum.UserInputType.MouseButton2,
    FOV_Enabled = true,
    FOV_Radius = 80,  -- empieza con 80 para test
    FOV_Color = Color3.fromRGB(255, 50, 50),
    FOV_LockedColor = Color3.fromRGB(255, 150, 150),
    FOV_Thickness = 2,
    FOV_Transparency = 0.8,
    FOV_Visible = true
}

local Descarado = getgenv().OwenDescaradoAimbot

local FOVCircle = Drawing.new("Circle")
FOVCircle.Visible = false
FOVCircle.Thickness = Descarado.FOV_Thickness
FOVCircle.NumSides = 60
FOVCircle.Transparency = Descarado.FOV_Transparency
FOVCircle.Filled = false

local function UpdateFOVCircle()
    FOVCircle.Radius = Descarado.FOV_Radius
    FOVCircle.Color = Descarado.FOV_Color
    FOVCircle.Thickness = Descarado.FOV_Thickness
    FOVCircle.Transparency = Descarado.FOV_Transparency
    FOVCircle.Visible = Descarado.FOV_Visible and Descarado.Enabled
    FOVCircle.Position = UIS:GetMouseLocation()
end

local function GetClosestTarget()
    local closest = nil
    local minDist = Descarado.FOV_Enabled and Descarado.FOV_Radius or math.huge
    local mousePos = UIS:GetMouseLocation()

    for _, plr in Players:GetPlayers() do
        if plr == LP then continue end
        if Descarado.TeamCheck and plr.Team == LP.Team then continue end

        local char = plr.Character
        if not char then continue end

        local humanoid = char:FindFirstChildOfClass("Humanoid")
        if not humanoid or humanoid.Health <= 0 then continue end

        local part = char:FindFirstChild(Descarado.LockPart)
        if not part then continue end

        local screenPos, onScreen = Camera:WorldToViewportPoint(part.Position)
        if not onScreen then continue end

        local dist = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
        if dist < minDist then
            if Descarado.WallCheck then
                local params = RaycastParams.new()
                params.FilterDescendantsInstances = {LP.Character or {}}
                params.FilterType = Enum.RaycastFilterType.Exclude
                local result = workspace:Raycast(Camera.CFrame.Position, (part.Position - Camera.CFrame.Position), params)
                if result and not result.Instance:IsDescendantOf(char) then continue end
            end
            minDist = dist
            closest = part
        end
    end
    return closest
end

local isAiming = false

UIS.InputBegan:Connect(function(input)
    if input.UserInputType == Descarado.TriggerKey and Descarado.Enabled then
        isAiming = true
        Camera.CameraType = Enum.CameraType.Scriptable
    end
end)

UIS.InputEnded:Connect(function(input)
    if input.UserInputType == Descarado.TriggerKey then
        isAiming = false
        Camera.CameraType = Enum.CameraType.Custom
    end
end)

RunService.RenderStepped:Connect(function()
    if not Descarado.Enabled then 
        FOVCircle.Visible = false
        return 
    end

    UpdateFOVCircle()

    if isAiming then
        local targetPart = GetClosestTarget()
        if targetPart then
            print("[DEBUG] Lock en: " .. targetPart.Parent.Name)
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, targetPart.Position + Vector3.new(0, 0.1, 0))
            FOVCircle.Color = Descarado.FOV_LockedColor
        else
            FOVCircle.Color = Descarado.FOV_Color
        end
    else
        FOVCircle.Color = Descarado.FOV_Color
    end
end)

-- Toggles y sliders (sin cambios, pero aseg√∫rate de tenerlos)
AimbotTab:CreateToggle({Name = "Enable Aimbot", CurrentValue = true, Callback = function(v) Descarado.Enabled = v; if not v then Camera.CameraType = Enum.CameraType.Custom end end})
AimbotTab:CreateToggle({Name = "Team Check", CurrentValue = false, Callback = function(v) Descarado.TeamCheck = v end})
AimbotTab:CreateToggle({Name = "Wall Check", CurrentValue = false, Callback = function(v) Descarado.WallCheck = v end})
AimbotTab:CreateToggle({Name = "Show FOV Circle", CurrentValue = true, Callback = function(v) Descarado.FOV_Visible = v end})
AimbotTab:CreateSlider({Name = "FOV Size (80 test / 30-40 rage)", Range = {1, 300}, Increment = 5, CurrentValue = 80, Callback = function(v) Descarado.FOV_Radius = v end})
-- ... agrega tus otros toggles de ESP y settings aqu√≠ (pega el resto de tu c√≥digo original)

Rayfield:LoadConfiguration()
print("Hub cargado con Rayfield desde GitHub raw")
