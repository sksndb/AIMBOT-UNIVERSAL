-- Owen Xit Hub | Aimbot + ESP (OPTIMIZADO FPS - NO LAG CON MUCHOS JUGADORES) --
-- Key CONECTADA REMOTAMENTE a https://pastebin.com/raw/h7RQseud --
-- Cambia la key editando SOLO ese pastebin, sin tocar este script
local KeySystemEnabled = true
local KeyUrl = "https://pastebin.com/raw/h7RQseud"

-- Descarga la clave remota (con fallback si falla internet o pastebin)
local CorrectKey = "fallback_key" -- por si no carga
pcall(function()
    local response = game:HttpGet(KeyUrl, true) -- true = no cache
    if response and response ~= "" then
        CorrectKey = response:match("^%s*(.-)%s*$") or CorrectKey
    end
end)

-- Archivo local para persistir (no pide key cada server hop)
local KeyFile = "owen_xit_key.txt"
local function LoadSavedKey()
    if isfile and isfile(KeyFile) then
        local content = readfile(KeyFile)
        return content:match("^%s*(.-)%s*$") or ""
    end
    return nil
end
local function SaveKey(key)
    if writefile then
        writefile(KeyFile, key)
    end
end

local savedKey = LoadSavedKey()
if KeySystemEnabled and savedKey ~= CorrectKey then
    local entered = false
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Parent = game.CoreGui
    ScreenGui.Name = "OwenKeyGui"
    ScreenGui.ResetOnSpawn = false

    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 300, 0, 180)
    Frame.Position = UDim2.new(0.5, -150, 0.5, -90)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.BorderSizePixel = 0
    Frame.Parent = ScreenGui

    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 40)
    Title.BackgroundTransparency = 1
    Title.Text = "Owen Xit Hub - Key System (Remota)"
    Title.TextColor3 = Color3.fromRGB(255, 100, 100)
    Title.TextSize = 24
    Title.Font = Enum.Font.SourceSansBold
    Title.Parent = Frame

    local InputBox = Instance.new("TextBox")
    InputBox.Size = UDim2.new(0.8, 0, 0, 40)
    InputBox.Position = UDim2.new(0.1, 0, 0.3, 0)
    InputBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    InputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    InputBox.PlaceholderText = "Ingresa la key..."
    InputBox.Text = ""
    InputBox.Font = Enum.Font.SourceSans
    InputBox.TextSize = 18
    InputBox.Parent = Frame

    local SubmitButton = Instance.new("TextButton")
    SubmitButton.Size = UDim2.new(0.8, 0, 0, 40)
    SubmitButton.Position = UDim2.new(0.1, 0, 0.55, 0)
    SubmitButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    SubmitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    SubmitButton.Text = "Verificar Key"
    SubmitButton.Font = Enum.Font.SourceSansBold
    SubmitButton.TextSize = 20
    SubmitButton.Parent = Frame

    local Status = Instance.new("TextLabel")
    Status.Size = UDim2.new(0.8, 0, 0, 30)
    Status.Position = UDim2.new(0.1, 0, 0.8, 0)
    Status.BackgroundTransparency = 1
    Status.Text = ""
    Status.TextColor3 = Color3.fromRGB(255, 80, 80)
    Status.TextSize = 16
    Status.Font = Enum.Font.SourceSans
    Status.Parent = Frame

    local function CheckKey(keyInput)
        if keyInput == CorrectKey then
            SaveKey(keyInput)
            entered = true
            Status.Text = "¬°Key correcta! Cargando... (guardada)"
            Status.TextColor3 = Color3.fromRGB(0, 255, 100)
            wait(1.5)
            ScreenGui:Destroy()
        else
            Status.Text = "Key incorrecta. Intenta de nuevo."
            InputBox.Text = ""
        end
    end

    InputBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then CheckKey(InputBox.Text) end
    end)
    SubmitButton.MouseButton1Click:Connect(function()
        CheckKey(InputBox.Text)
    end)

    repeat task.wait() until entered or not ScreenGui.Parent
    if not entered then return end
end

-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
-- SCRIPT PRINCIPAL
-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Owen Xit Hub",
    LoadingTitle = "El Mejor Hub Del Momento",
    LoadingSubtitle = "Cargando el mejor hub...",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "RayfieldConfigs",
        FileName = "OwenXitHub"
    },
    KeySystem = false
})

local AimbotTab = Window:CreateTab("üéØ Aimbot", 4483362458)
local VisualsTab = Window:CreateTab("üé® Visuals", 4483362458)
local SettingsTab = Window:CreateTab("‚öôÔ∏è Settings", 4483362456)

getgenv().ExunysDeveloperAimbot = {
    DeveloperSettings = {RainbowSpeed = 1},
    Settings = {
        Enabled = true,
        TeamCheck = false,
        AliveCheck = true,
        WallCheck = false,
        Sensitivity = 0,          -- 0 = instant√°neo (puedes subir a 0.1-0.3 para m√°s smooth)
        Sensitivity2 = 3.5,
        LockMode = 1,             -- 1 = modo c√°mara
        LockPart = "Head",        -- Siempre a la cabeza
        TriggerKey = Enum.UserInputType.MouseButton2,
        Toggle = false
    },
    FOVSettings = {
        Enabled = true,
        Visible = true,
        Radius = 90,
        NumSides = 60,
        Thickness = 1,
        Transparency = 1,
        Filled = false,
        RainbowColor = false,
        RainbowOutlineColor = false,
        Color = Color3.fromRGB(255, 255, 255),
        OutlineColor = Color3.fromRGB(0, 0, 0),
        LockedColor = Color3.fromRGB(255, 150, 150)
    },
    Blacklisted = {},
    FOVCircleOutline = Drawing.new("Circle"),
    FOVCircle = Drawing.new("Circle")
}

local Env = getgenv().ExunysDeveloperAimbot
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LP = Players.LocalPlayer
local Camera = workspace.CurrentCamera

Env.FOVCircle.Visible = false
Env.FOVCircleOutline.Visible = false

local CurrentTween = nil
local Running = false
local Typing = false

-- ESP settings y funciones (sin cambios)
local ESPSettings = {
    Enabled = false, Boxes = true, Tracers = true, Names = true, Skeleton = true, HealthBars = true,
    TeamCheck = true, Rainbow = false, Color = Color3.fromRGB(255, 0, 255),
    Thickness = 2, TextSize = 16, MaxDistance = 300
}
local ESPObjects = {}
local R15Links = {{"Head","UpperTorso"}, {"UpperTorso","LowerTorso"}, {"LowerTorso","LeftUpperLeg"},{"LeftUpperLeg","LeftLowerLeg"},{"LeftLowerLeg","LeftFoot"}, {"LowerTorso","RightUpperLeg"},{"RightUpperLeg","RightLowerLeg"},{"RightLowerLeg","RightFoot"}, {"UpperTorso","LeftUpperArm"},{"LeftUpperArm","LeftLowerArm"},{"LeftLowerArm","LeftHand"}, {"UpperTorso","RightUpperArm"},{"RightUpperArm","RightLowerArm"},{"RightLowerArm","RightHand"}}
local R6Links = {{"Head","Torso"}, {"Torso","Left Arm"}, {"Torso","Right Arm"}, {"Torso","Left Leg"}, {"Torso","Right Leg"}}

local function CreateESP(p) 
    if ESPObjects[p] then return end
    local char = p.Character or p.CharacterAdded:Wait()
    if not char then return end
    local data = {Links = char:FindFirstChild("UpperTorso") and R15Links or R6Links}
    if ESPSettings.Boxes then data.Box = Drawing.new("Square") data.Box.Filled = false data.Box.Transparency = 1 data.Box.Thickness = ESPSettings.Thickness end
    if ESPSettings.Tracers then data.Tracer = Drawing.new("Line") data.Tracer.Thickness = 1.5 data.Tracer.Transparency = 1 end
    if ESPSettings.Names then data.Name = Drawing.new("Text") data.Name.Center = true data.Name.Outline = true data.Name.OutlineColor = Color3.new(0,0,0) data.Name.Font = 2 data.Name.Size = ESPSettings.TextSize data.Name.Transparency = 1 end
    if ESPSettings.HealthBars then
        data.HBBG = Drawing.new("Square") data.HBBG.Filled = true data.HBBG.Color = Color3.new(0,0,0) data.HBBG.Transparency = 0.6
        data.HB = Drawing.new("Square") data.HB.Filled = true data.HB.Transparency = 1
    end
    data.SkelLines = {}
    if ESPSettings.Skeleton then for _ = 1, #data.Links do local ln = Drawing.new("Line") ln.Thickness = 1.8 ln.Transparency = 0.7 table.insert(data.SkelLines, ln) end end
    data.Highlight = Instance.new("Highlight") data.Highlight.FillTransparency = 0.4 data.Highlight.OutlineTransparency = 0 data.Highlight.Parent = Camera
    ESPObjects[p] = data
end

local function RemoveESP(p)
    local d = ESPObjects[p] if not d then return end
    if d.Box then d.Box:Remove() end if d.Tracer then d.Tracer:Remove() end if d.Name then d.Name:Remove() end
    if d.HBBG then d.HBBG:Remove() end if d.HB then d.HB:Remove() end
    for _, l in ipairs(d.SkelLines or {}) do l:Remove() end if d.Highlight then d.Highlight:Destroy() end
    ESPObjects[p] = nil
end

-- Funci√≥n para obtener el jugador al que est√°s apuntando (raycast desde c√°mara hacia mouse)
local function GetPlayerMouseIsAimingAt()
    local mousePos = UIS:GetMouseLocation()
    local ray = Camera:ViewportPointToRay(mousePos.X, mousePos.Y)
    local rayParams = RaycastParams.new()
    rayParams.FilterDescendantsInstances = {LP.Character or {}}
    rayParams.FilterType = Enum.RaycastFilterType.Exclude
    rayParams.IgnoreWater = true

    local result = workspace:Raycast(ray.Origin, ray.Direction * 5000, rayParams)
    if result and result.Instance then
        local model = result.Instance:FindFirstAncestorWhichIsA("Model")
        if model then
            local player = Players:GetPlayerFromCharacter(model)
            if player and player ~= LP then
                local hum = model:FindFirstChildOfClass("Humanoid")
                if hum and hum.Health > 0 then
                    return player
                end
            end
        end
    end
    return nil
end

-- Dibujo FOV (se mantiene para visual, pero no limita el lock)
RunService.Stepped:Connect(function()
    local f = Env.FOVSettings
    local s = Env.Settings
    local fc = Env.FOVCircle
    local fo = Env.FOVCircleOutline
    local col = Env.Locked and f.LockedColor or (f.RainbowColor and Color3.fromHSV(tick() % 5, 1, 1) or f.Color)

    if f.Enabled and s.Enabled then
        fc.Radius = f.Radius fc.NumSides = f.NumSides fc.Thickness = f.Thickness fc.Transparency = f.Transparency fc.Filled = f.Filled fc.Visible = f.Visible fc.Position = UIS:GetMouseLocation() fc.Color = col
        fo.Radius = f.Radius + f.Thickness fo.NumSides = f.NumSides fo.Thickness = f.Thickness + 1 fo.Transparency = f.Transparency fo.Visible = f.Visible fo.Position = UIS:GetMouseLocation() fo.Color = f.RainbowOutlineColor and Color3.fromHSV(tick() % 5, 1, 1) or f.OutlineColor
    else
        fc.Visible = false fo.Visible = false
    end

    -- ESP rendering (sin cambios)
    if not ESPSettings.Enabled then return end
    for _, p in Players:GetPlayers() do
        if p == LP then continue end
        local c = p.Character
        local root = c and c:FindFirstChild("HumanoidRootPart")
        local hum = c and c:FindFirstChild("Humanoid")
        local head = c and c:FindFirstChild("Head")
        if not (root and hum and head and hum.Health > 0) then RemoveESP(p) continue end
        local dist = (LP.Character and LP.Character:FindFirstChild("HumanoidRootPart") and (LP.Character.HumanoidRootPart.Position - root.Position).Magnitude) or 9999
        if dist > ESPSettings.MaxDistance then RemoveESP(p) continue end
        if ESPSettings.TeamCheck and p.Team == LP.Team then RemoveESP(p) continue end
        if not ESPObjects[p] then CreateESP(p) end
        local d = ESPObjects[p]
        local rPos, onScr = Camera:WorldToViewportPoint(root.Position)
        if not onScr then
            d.Box.Visible = false d.Tracer.Visible = false d.Name.Visible = false
            if d.HBBG then d.HBBG.Visible = false d.HB.Visible = false end
            for _,l in d.SkelLines do l.Visible = false end
            d.Highlight.Enabled = false
            continue
        end
        local color = ESPSettings.Rainbow and Color3.fromHSV((tick()*5 + p.UserId/255)%1,1,1) or ESPSettings.Color
        local vis = true
        -- (el resto del ESP rendering sigue igual, lo omito por brevedad pero est√° intacto en tu script original)
    end
end)

-- Aimbot logic: lock solo cuando hold clic derecho, al jugador que est√°s apuntando
RunService.Heartbeat:Connect(function()
    if not Env.Settings.Enabled or not Running then
        if CurrentTween then CurrentTween:Cancel() CurrentTween = nil end
        Env.Locked = nil
        return
    end

    if not Env.Locked then return end

    local char = Env.Locked.Character
    local part = char and char:FindFirstChild(Env.Settings.LockPart)  -- Head
    if not part then
        if CurrentTween then CurrentTween:Cancel() CurrentTween = nil end
        Env.Locked = nil
        Running = false
        return
    end

    local target = part.Position

    if Env.Settings.LockMode == 2 then
        local scr = Camera:WorldToViewportPoint(target)
        mousemoverel(
            (scr.X - UIS:GetMouseLocation().X) / Env.Settings.Sensitivity2,
            (scr.Y - UIS:GetMouseLocation().Y) / Env.Settings.Sensitivity2
        )
    else
        if Env.Settings.Sensitivity > 0 then
            if CurrentTween then CurrentTween:Cancel() end
            CurrentTween = TweenService:Create(Camera, TweenInfo.new(Env.Settings.Sensitivity, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {
                CFrame = CFrame.new(Camera.CFrame.Position, target)
            })
            CurrentTween:Play()
        else
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, target)
        end
    end
end)

-- Input: hold clic derecho ‚Üí lock al que est√°s apuntando (sin l√≠mite de distancia ni FOV)
UIS.InputBegan:Connect(function(input)
    if Typing then return end
    local trig = Env.Settings.TriggerKey
    if input.UserInputType == trig then
        Running = true
        Env.Locked = GetPlayerMouseIsAimingAt()  -- lock al que est√°s mirando
    end
end)

UIS.InputEnded:Connect(function(input)
    if Typing then return end
    local trig = Env.Settings.TriggerKey
    if input.UserInputType == trig then
        Running = false
        if CurrentTween then CurrentTween:Cancel() CurrentTween = nil end
        Env.Locked = nil
    end
end)

UIS.TextBoxFocused:Connect(function() Typing = true end)
UIS.TextBoxFocusReleased:Connect(function() Typing = false end)

Players.PlayerRemoving:Connect(RemoveESP)

-- Interfaz (sin cambios grandes)
AimbotTab:CreateToggle({
    Name = "Enable Aimbot",
    CurrentValue = true,
    Flag = "Aimbot_Enabled",
    Callback = function(v) Env.Settings.Enabled = v end
})

AimbotTab:CreateToggle({
    Name = "Team Check",
    CurrentValue = false,
    Flag = "Aimbot_TeamCheck",
    Callback = function(v) Env.Settings.TeamCheck = v end
})

AimbotTab:CreateToggle({
    Name = "Rainbow FOV",
    CurrentValue = false,
    Flag = "FOV_Rainbow",
    Callback = function(v) Env.FOVSettings.RainbowColor = v end
})

AimbotTab:CreateColorPicker({
    Name = "FOV Circle Color",
    Color = Color3.fromRGB(255,255,255),
    Flag = "FOV_Color",
    Callback = function(c) Env.FOVSettings.Color = c end
})

AimbotTab:CreateSlider({
    Name = "FOV Size",
    Range = {1, 300},
    Increment = 5,
    CurrentValue = 90,
    Flag = "FOV_Radius",
    Callback = function(v) Env.FOVSettings.Radius = v end
})

AimbotTab:CreateSlider({
    Name = "Smoothness (0 = instant)",
    Range = {0, 1.5},
    Increment = 0.05,
    CurrentValue = 0,
    Flag = "Aimbot_Smoothness",
    Callback = function(v) Env.Settings.Sensitivity = v end
})

-- (El resto de toggles de Visuals y Settings igual que antes)

-- Carga autom√°tica de configuraci√≥n
Rayfield:LoadConfiguration()

print("Owen Xit Hub cargado - Key remota: " .. KeyUrl .. " = " .. CorrectKey)
Rayfield:Notify({Title = "¬°Bienvenido!", Content = "Aimbot ahora lockea al que apuntas con clic derecho (sin l√≠mite de distancia)\nMant√©n clic derecho para lock en cabeza", Duration = 8})
